# SmartShield Backend Configuration
# Copy this file to .env and fill in your values

# Server Configuration
PORT=4000
NODE_ENV=development
BASE_URL=http://localhost:4000

# Database Configuration
DATABASE_URL=postgres://postgres:password@localhost:5432/smartshield
REDIS_URL=redis://localhost:6379

# Authentication
JWT_SECRET=your_super_secret_jwt_key_change_this_in_production

# Model Provider Configuration
MODEL_PROVIDER=gemini
MODEL_NAME=gemini-1.5-flash
GEMINI_API_KEY=your_gemini_api_key_here
OPENAI_API_KEY=your_openai_api_key_here

# Extension Configuration
EXTENSION_BACKEND_URL=http://localhost:4000

# Analytics and Privacy
RETENTION_DAYS=365
PRIVACY_MODE=true
PII_REDACTION=true

# Security and Monitoring
SENTRY_DSN=
CORS_ORIGINS=http://localhost:3000,http://localhost:4000

# Detection Thresholds
LOW_THRESHOLD=0.3
HIGH_THRESHOLD=0.7
REPORT_THRESHOLD=0.8

# Rate Limiting
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW=900000

# Debug Mode
DEBUG_MODE=true

# Configurable Prompt Templates
# You can customize these prompts to change how the AI analyzes content

ANALYSIS_PROMPT_TEMPLATE="You are a cybersecurity expert specializing in phishing detection. Analyze the following content and determine if it's a phishing attempt.

URL: {url}
Content: {content}

Please respond with a JSON object containing:
{
  \"score\": 0.0-1.0 (0 = definitely clean, 1 = definitely phishing),
  \"label\": \"suspicious\" | \"clean\" | \"uncertain\",
  \"reasons\": [\"reason1\", \"reason2\", ...],
  \"explanation\": \"Brief explanation of the analysis\",
  \"confidence\": 0.0-1.0
}

Look for common phishing indicators:
- Urgent language demanding immediate action
- Requests for sensitive information (passwords, SSN, credit cards)
- Suspicious URLs or domains
- Poor grammar/spelling
- Threats or consequences for not acting
- Impersonation of legitimate organizations
- Unusual formatting or styling
- Suspicious file attachments

Respond with ONLY the JSON object, no additional text."

CHAT_PROMPT_TEMPLATE="You are a helpful cybersecurity assistant. A user has flagged the following content as potentially suspicious and is asking for an explanation:

CONTEXT:
{context}

USER QUESTION: {question}

Please provide a clear, helpful explanation. If the content appears to be phishing, explain why and what the user should do. If it appears legitimate, explain why and provide reassurance.

Keep your response concise but informative (2-3 sentences max)."